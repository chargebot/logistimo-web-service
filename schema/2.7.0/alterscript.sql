ALTER TABLE INVNTRY ADD COLUMN IAT DATETIME DEFAULT NULL;
ALTER TABLE DEMANDITEM ADD COLUMN RQ DECIMAL(16,4) DEFAULT NULL AFTER DQ;

UPDATE INVNTRY AS I LEFT JOIN (SELECT MIN(T) AS UT, KID, MID FROM TRANSACTION GROUP BY KID, MID) AS T ON I.KID = T.KID AND I.MID = T.MID
SET I.IAT = T.UT;

create index INVNTRYEVNTLOG_TY_ED on INVNTRYEVNTLOG(TY,ED);

CREATE TABLE RETURNS (
    id BIGINT(20) NOT NULL AUTO_INCREMENT,
    source_domain BIGINT(20) DEFAULT NULL,
    order_id BIGINT(20) DEFAULT NULL,
    customer_id BIGINT(20) DEFAULT NULL,
    vendor_id BIGINT(20) DEFAULT NULL,
    latitude DOUBLE DEFAULT NULL,
    longitude DOUBLE DEFAULT NULL,
    geo_accuracy DOUBLE DEFAULT NULL,
    geo_error VARCHAR(255) DEFAULT NULL,
    status VARCHAR(25) DEFAULT NULL,
    cancel_reason VARCHAR(255) DEFAULT NULL,
    status_updated_at DATETIME DEFAULT NULL,
    status_updated_by VARCHAR(25) DEFAULT NULL,
    created_at DATETIME DEFAULT NULL,
    created_by VARCHAR(25) DEFAULT NULL,
    updated_at DATETIME DEFAULT NULL,
    updated_by VARCHAR(25) DEFAULT NULL,
    source INT(3) DEFAULT NULL,
    PRIMARY KEY (`ID`)
)  ENGINE=INNODB AUTO_INCREMENT=1001100 DEFAULT CHARSET=UTF8;


CREATE TABLE RETURNS_ITEM (
    id BIGINT(20) NOT NULL AUTO_INCREMENT,
    returns_id BIGINT(20) DEFAULT NULL,
    material_id BIGINT(20) DEFAULT NULL,
    quantity DECIMAL(16 , 4 ) DEFAULT NULL,
    material_status VARCHAR(255) DEFAULT NULL,
    reason VARCHAR(255) DEFAULT NULL,
    received_quantity DECIMAL(16 , 4 ) DEFAULT NULL,
    received_material_status VARCHAR(255) DEFAULT NULL,
    discrepancy_reason VARCHAR(255) DEFAULT NULL,
    created_at DATETIME DEFAULT NULL,
    created_by VARCHAR(25) DEFAULT NULL,
    updated_at DATETIME DEFAULT NULL,
    updated_by VARCHAR(25) DEFAULT NULL,
    PRIMARY KEY (`ID`)
)  ENGINE=INNODB AUTO_INCREMENT=1000100 DEFAULT CHARSET=UTF8;


CREATE TABLE RETURNS_ITEM_BATCH (
    id BIGINT(20) NOT NULL AUTO_INCREMENT,
    item_id BIGINT(20) DEFAULT NULL,
    batch_id VARCHAR(255) DEFAULT NULL,
    expiry DATETIME DEFAULT NULL,
    manufacturer VARCHAR(255) DEFAULT NULL,
    manufactured DATETIME DEFAULT NULL,
    quantity DECIMAL(16 , 4 ) DEFAULT NULL,
    material_status VARCHAR(255) DEFAULT NULL,
    reason VARCHAR(255) DEFAULT NULL,
    received_quantity DECIMAL(16 , 4 ) DEFAULT NULL,
    received_material_status VARCHAR(255) DEFAULT NULL,
    discrepancy_reason VARCHAR(255) DEFAULT NULL,
    PRIMARY KEY (`ID`)
)  ENGINE=INNODB AUTO_INCREMENT=1000100 DEFAULT CHARSET=UTF8;